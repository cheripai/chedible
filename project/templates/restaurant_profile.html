{#    Copyright 2015 Dat Do
    
    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
    
        http://www.apache.org/licenses/LICENSE-2.0
    
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
#}


{% extends "_base.html" %}

{% block content %}

    <script type=text/javascript>
      $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    </script>
    <div class="container">
        <div class="col-lg-8">
            <div class="page-header">
                <h2>
                    {% if restaurant.image %}
                        <img src="{{ restaurant.image }}" class="img-thumbnail" height="200" width="200"/>
                    {% else %}
                        <img class="img-thumbnail" src="http://www.indre-reisid.ee/wp-content/themes/envision/lib/images/default-placeholder.png" height="200" width="200"/>
                    {% endif %}
                    {{ restaurant.name }}
                    {% if g.user %}
                        <small><small><a href="{{ url_for('edit_restaurant', id=restaurant.id) }}">Edit</a></small></small>
                    {% endif %}
                </h2>
                {% if g.user %}
                    <a href="{{ url_for('add_dish', id=restaurant.id) }}"><button type="button" class="btn btn-primary">Add a dish</button></a>
                {% else %}
                    <a href="#mustlogin" data-toggle="modal"><button type="button" class="btn btn-primary">Add a dish</button></a>
                {% endif %}
            </div>  
            <p>{{ message }}</p>
            <div class="media">
                {% for d in dishes %}
                    <div class="entry">
                        <div class="pull-left media-middle">
                            {% if d.image %}
                                <img class="img-thumbnail media-object entry-thumbnail" src="{{ d.image }}" height="80" width="80"/>
                            {% else %}
                                <img class="img-thumbnail media-object entry-thumbnail" src="http://www.indre-reisid.ee/wp-content/themes/envision/lib/images/default-placeholder.png" height="80" width="80"/>
                            {% endif %}
                        </div>
                        <div class="media-body">
                            <div class="col-lg-6">
                                <h4 class="media-heading">{{ d.name }}{% if g.user %} <small><small><a href="{{ url_for('edit_dish', restaurant_id=restaurant.id, dish_id=d.id) }}">Edit</a></small></small>{% endif %}</h4>
                                <p class="text-muted">{{ d.price }}</p>
                                <h5><p class="text-muted">
                                    {% if g.user %}
                                        <a href="javascript:;" title="Information is accurate"><i class="glyphicon glyphicon-chevron-up" id="upvote{{ d.id }}"></i></a>
                                        <span id="count{{ d.id }}"> {{ d.score }} </span>
                                        <a href="javascript:;" title="Information is not accurate"><i class="glyphicon glyphicon-chevron-down" id="downvote{{ d.id }}"></i></a>
                                    {% else %}
                                        <a href="#mustlogin" data-toggle="modal" title="Information is accurate"><i class="glyphicon glyphicon-chevron-up" id="upvote{{ d.id }}"></i></a>
                                        <span id="count{{ d.id }}"> {{ d.score }} </span>
                                        <a href="#mustlogin" data-toggle="modal" title="Information is not accurate"><i class="glyphicon glyphicon-chevron-down" id="downvote{{ d.id }}"></i></a>
                                    {% endif %}
                                </p></h5>
                            </div>
                            <div class="col-lg-6">
                                {% set contents = ['beef', 'dairy', 'egg', 'fish', 'gluten', 'meat', 'nut', 'pork', 'poultry', 'shellfish', 'soy', 'wheat'] %}
                                <h4>Contains:
                                    <small>
                                        {% for c in contents %}
                                            {% if d[c] == True %}
                                                {{ c.title() }}
                                            {% endif %}
                                        {% endfor %}
                                    </small>
                                </h4>
                                <h4>May Contain:
                                    <small>
                                        {% for c in contents %}
                                            {% if d[c] == None %}
                                                {{ c.title() }}
                                            {% endif %}
                                        {% endfor %}
                                    </small>
                                </h4>
                            </div>
                        </div>
                        <hr class="featurette-divider"></hr>
                    </div>
                {% endfor %}
            </div>
            <nav>
                {% if pagination %}
                    <ul class="pagination">
                        {% if pagination.has_prev %}
                            <li>
                                <a href="{{ url_for('restaurant_profile', id=restaurant.id, page=pagination.page-1) }}" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                        {% endif %}
                        {% if pagination.pages == 0 %}
                            <li><span>Page {{ pagination.page }} of 1</span></li>
                        {% else %}
                            <li><span>Page {{ pagination.page }} of {{ pagination.pages }}</span></li>
                        {% endif %}
                        {% if pagination.has_next %}
                            <li>
                                <a href="{{ url_for('restaurant_profile', id=restaurant.id, page=pagination.page+1) }}" aria-label="Previous">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                {% endif %}
            </nav>
        </div>

        <div class="col-lg-1">
        </div>

        <div class="col-lg-3">
            <div class="list-group">
                <a href="#" class="list-group-item">
                    <h4 class="list-group-item-heading">Ads n shit</h4>
                    <p class="list-group-item-text">
Donec hendrerit nunc eget elit pharetra pulvinar. Suspendisse id tempus tortor. Aenean luctus, elit commodo laoreet commodo, justo nisi consequat massa, sed vulputate quam urna quis eros. Donec vel. 
Donec hendrerit nunc eget elit pharetra pulvinar. Suspendisse id tempus tortor. Aenean luctus, elit commodo laoreet commodo, justo nisi consequat massa, sed vulputate quam urna quis eros. Donec vel. 
Donec hendrerit nunc eget elit pharetra pulvinar. Suspendisse id tempus tortor. Aenean luctus, elit commodo laoreet commodo, justo nisi consequat massa, sed vulputate quam urna quis eros. Donec vel. 
Donec hendrerit nunc eget elit pharetra pulvinar. Suspendisse id tempus tortor. Aenean luctus, elit commodo laoreet commodo, justo nisi consequat massa, sed vulputate quam urna quis eros. Donec vel. 
                    </p>
                </a>
            </div>
        </div>

    </div>

{% endblock %}
